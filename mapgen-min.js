function RNG(e){this.m=2147483648,this.a=1103515245,this.c=12345,this.state=e||Math.floor(Math.random()*(this.m-1))}RNG.prototype.nextInt=function(){return this.state=(this.a*this.state+this.c)%this.m,this.state},RNG.prototype.nextFloat=function(){return this.nextInt()/(this.m-1)},RNG.prototype.nextRange=function(e,l){var t=l-e,a=this.nextInt()/this.m;return e+Math.floor(a*t)},RNG.prototype.choice=function(e){return e[this.nextRange(0,e.length)]};var PERLIN_YWRAPB=4,PERLIN_YWRAP=1<<PERLIN_YWRAPB,PERLIN_ZWRAPB=8,PERLIN_ZWRAP=1<<PERLIN_ZWRAPB,PERLIN_SIZE=4095,perlin_octaves=4,perlin_amp_falloff=.5;seed=[],myrng=new RNG(1e87*Math.round(Math.random()));var perlin,scaled_cosine=function(e){return.5*(1-Math.cos(e*Math.PI))};function noise(e,l,t){if(l=l||0,t=t||0,null==perlin){perlin=new Array(PERLIN_SIZE+1);for(var a=0;a<PERLIN_SIZE+1;a++)y=myrng.nextFloat(),perlin[a]=y,seed.push(y)}e<0&&(e=-e),l<0&&(l=-l),t<0&&(t=-t);for(var r,n,i,o,c,p=Math.floor(e),s=Math.floor(l),f=Math.floor(t),u=e-p,d=l-s,A=t-f,y=0,g=.5,h=0;h<perlin_octaves;h++){var R=p+(s<<PERLIN_YWRAPB)+(f<<PERLIN_ZWRAPB);r=scaled_cosine(u),n=scaled_cosine(d),i=perlin[R&PERLIN_SIZE],i+=r*(perlin[R+1&PERLIN_SIZE]-i),o=perlin[R+PERLIN_YWRAP&PERLIN_SIZE],i+=n*((o+=r*(perlin[R+PERLIN_YWRAP+1&PERLIN_SIZE]-o))-i),o=perlin[(R+=PERLIN_ZWRAP)&PERLIN_SIZE],o+=r*(perlin[R+1&PERLIN_SIZE]-o),c=perlin[R+PERLIN_YWRAP&PERLIN_SIZE],o+=n*((c+=r*(perlin[R+PERLIN_YWRAP+1&PERLIN_SIZE]-c))-o),y+=(i+=scaled_cosine(A)*(o-i))*g,g*=perlin_amp_falloff,p<<=1,s<<=1,f<<=1,(u*=2)>=1&&(p++,u--),(d*=2)>=1&&(s++,d--),(A*=2)>=1&&(f++,A--)}return y}function map(e,l,t,a,r){return a+(r-a)*(e-l)/(t-l)}let triggerSlider=document.getElementById("trigger"),ampfalloffSlider=document.getElementById("ampfalloff"),qualitySlider=document.getElementById("quality"),moveSpeedSlider=document.getElementById("move speed");function getSeed(){str="";for(let e=0;e<seed.length;e++)str+=seed[e]+";";console.log(str)}triggerSlider.oninput=function(){sandtrigger=this.value,grasstrigger=this.value+.05,snowtrigger=this.value+.15},ampfalloffSlider.oninput=function(){perlin_amp_falloff=this.value},qualitySlider.oninput=function(){quality=parseInt(this.value)},moveSpeedSlider.oninput=function(){speed=this.value},canvas=document.getElementById("map"),ctx=canvas.getContext("2d"),canvas.height=700,canvas.width=700;let quality=8,xoff=0,yoff=0,speed=4,zoom=.01,sandtrigger=.6,grasstrigger=sandtrigger+.05,snowtrigger=sandtrigger+.15;var keys={};function drawLand(){xoff<0&&(xoff=0),yoff<0&&(yoff=0),keys[83]&&(yoff+=quality*speed),keys[87]&&(yoff-=quality*speed),keys[65]&&(xoff-=quality*speed),keys[68]&&(xoff+=quality*speed),keys[82]&&(zoom*=1.05),keys[70]&&(zoom*=.95),ctx.fillStyle="#170DE0",ctx.fillRect(0,0,canvas.width,canvas.height);for(let e=0;e<canvas.width;e+=quality)for(let l=0;l<canvas.height;l+=quality)ctx.fillStyle="#2FC816",value=noise((e+xoff)*zoom,(l+yoff)*zoom),value>snowtrigger?(ctx.fillStyle="rgb(255, 255, 255)",ctx.fillRect(e,l,quality,quality)):value>grasstrigger?(ctx.fillStyle="rgb(0, "+map(value,0,1,255,0)+",0)",ctx.fillRect(e,l,quality,quality)):value>sandtrigger&&(ctx.fillStyle="#E9E75D",ctx.fillRect(e,l,quality,quality))}function exportOBJ(){let e="o object\n";for(let l=0;l<canvas.width;l+=quality)for(let t=0;t<canvas.height;t+=quality){let a="v "+l+" "+t+" ";noise((l+xoff)*zoom,(t+yoff)*zoom)>trigger?a+=map(noise(.01*(l+xoff),.01*(t+yoff)),0,1,255,0):a+=map(trigger,0,1,255,0),e+=a+"\n"}for(let l=0;l<canvas.width-16;l+=quality)for(let t=0;t<canvas.height-16;t+=quality){let a=l/8+1+(t/8+1)*Math.round(canvas.width/quality),r=l/8+1+(t/8+1)*Math.round(canvas.width/quality)+1,n=l/8+1+(t/8+1+1)*Math.round(canvas.width/quality)+1,i=l/8+1+(t/8+1+1)*Math.round(canvas.width/quality);n>=7744&&(n=0),i>=7744&&(i=0),a>=7655&&(a=0),r>=7656&&(r=0),e+="f "+a+" "+r+" "+i+" "+n+"\n",160==l&&160==t&&console.table([a,r,i,n])}console.log(e)}function setseed(){let e=document.getElementById("seed").value;console.log(e.value),e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replaceAll("a",1)).replaceAll("b",2)).replaceAll("c",3)).replaceAll("d",4)).replaceAll("e",5)).replaceAll("f",6)).replaceAll("g",7)).replaceAll("h",8)).replaceAll("i",9)).replaceAll("j",10)).replaceAll("k",11)).replaceAll("l",12)).replaceAll("m",13)).replaceAll("n",14)).replaceAll("o",15)).replaceAll("p",16)).replaceAll("q",17)).replaceAll("r",18)).replaceAll("s",19)).replaceAll("t",20)).replaceAll("u",21)).replaceAll("v",22)).replaceAll("w",23)).replaceAll("x",24)).replaceAll("y",25)).replaceAll("z",26)).replaceAll("A",27)).replaceAll("B",28)).replaceAll("C",29)).replaceAll("D",30)).replaceAll("E",31)).replaceAll("F",32)).replaceAll("G",33)).replaceAll("H",34)).replaceAll("I",35)).replaceAll("J",36)).replaceAll("K",37)).replaceAll("L",38)).replaceAll("M",39)).replaceAll("N",40)).replaceAll("O",41)).replaceAll("P",42)).replaceAll("Q",43)).replaceAll("R",44)).replaceAll("S",45)).replaceAll("T",46)).replaceAll("U",47)).replaceAll("V",48)).replaceAll("W",49)).replaceAll("X",50)).replaceAll("Y",51)).replaceAll("Z",52)).replaceAll(" ",53),perlin=null,myrng=new RNG(parseInt(e))}window.onkeyup=function(e){keys[e.keyCode]=!1},window.onkeydown=function(e){keys[e.keyCode]=!0},setInterval(drawLand,100),String.prototype.replaceAll=function(e,l){return this.replace(new RegExp(e,"g"),l)};